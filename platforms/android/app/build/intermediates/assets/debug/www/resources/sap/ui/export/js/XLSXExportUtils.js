(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.XLSXExportUtils=f()}})(function(){var d,m,b;return(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(r,m,b){var O=r("./provider/ODataDataProvider.js");var F=r("./filesaver/FileSaver.js");m.exports={oData:{fetch:O.requestData,getConverter:O.getConverter},saveFile:F.saveFile};},{"./filesaver/FileSaver.js":2,"./provider/ODataDataProvider.js":3}],2:[function(r,m,b){function s(a,n){var l,c,S;if(!(a instanceof Blob)){return}l=document.createElementNS("http://www.w3.org/1999/xhtml","a");c="download"in l;if(c){S=function(f,g){l.download=g;l.href=URL.createObjectURL(f);l.dispatchEvent(new MouseEvent("click"))}}if(typeof S==="undefined"){S=function(f){var g=new FileReader;g.onloadend=function(){var o,u;u=g.result.replace(/^data:[^;]*;/,"data:attachment/file;");o=window.open(u,"_blank");if(!o){window.location.href=u}};g.readAsDataURL(a)}}if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){S=function(f,g){window.navigator.msSaveOrOpenBlob(f,g)}}S(a,n)}m.exports={saveFile:s};},{}],3:[function(r,m,b){var R=r("./RequestHandler.js");var M=1e6;var j=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/;function p(v){var l,n,o;if(v==null){return null}if(typeof v==="object"){v=v.valueOf()}if(typeof v==="number"){return v}if(j.test(v)){l=j.exec(v);n=new Date(parseInt(l[1],10));if(l[2]&&l[3]){o=parseInt(l[2]+l[3],10);n.setUTCMinutes(n.getUTCMinutes()-o)}return n.getTime()}if(isFinite(v)){return parseInt(v,10)}n=new Date(v);if(isFinite(n)){return n.getTime()}return null}var a=/^([+-])?P(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)(?:\.(\d+))?S)?)?/;function c(v){if(v instanceof Date){return v.getTime()}else if(v&&v.__edmType==="Edm.Time"){return v.ms}else if(typeof v==="string"&&a.test(v)){var l=a.exec(v);var y=l[2]||"0";var n=l[3]||"0";var o=parseInt(l[4]||0,10);var q=parseInt(l[5]||0,10);var s=parseInt(l[6]||0,10);var t=parseFloat(l[7]||0);if(y!=="0"||n!=="0"){return v}var u=l[8];if(!u){u=0}else{u=parseFloat("0."+u)*1e3}u+=t*1e3+s*6e4+q*36e5+o*864e5;if(l[1]==="-"){u=-u}v=u}return v}function g(o,C){var v=C.keys.reduce(function(l,n){return l&&l[n]},o);if(v){if(C.type==="date"||C.type==="datetime"){v=p(v)}else if(C.type==="time"){v=c(v)}}return v}function f(l,C){C.forEach(function(n){l.forEach(function(o){o[n.property]=g(o,n)})});return l}function h(s){return s.workbook.columns.reduce(function(l,n){var o=n.property instanceof Array?n.property:[n.property];o.forEach(function(q){var K=q.split("/");if(K.length>1||n.type==="date"||n.type==="datetime"||n.type==="time"){l.push({property:q,keys:K,type:n.type})}});return l},[])}function i(s){var C=h(s);return function(l){return f(l,C)}}function k(s,P){var A=0;var D=s.dataSource;var t=Math.min(D.count||M,M);var B=Math.min(D.sizeLimit||M,s.batchSize||M,t);var C=false;var l=D.dataUrl;var n=i(s);var o;function q(w){if(!w)return"";var U=URI.parse(w);U.path=U.path||"";if(U.path.slice(-1)!=="/"){U.path=U.path+"/"}delete U.query;delete U.hash;delete U.fragment;return(URI.serialize||URI.build)(U)}function u(S,T,N){var w=URI.parse(l);if(N){var x=URI.parse(N);w.query=x.query}else{var Q=(w.query||"").split("&");var y={};Q.forEach(function(E){var F=E.split("=");if(F[0]){y[F[0]]=F[1]}});y["$skip"]=S;y["$top"]=T;Q=[];for(var z in y){Q.push(z+(y[z]==null?"":"="+y[z]))}w.query=Q.join("&")}return(URI.serialize||URI.build)(w)}function O(w){P({error:w})}function v(w){var x,N,F,y,z;var E={};if(C){return}x=w&&w.d&&(w.d.results||w.d)||w;x=Array.isArray(x)?x:[];F=x.length;A+=F;z=t-A;y=A/t;E.finished=F===0||z<=0;E.progress=Math.round(y*100);N=w&&w.d&&w.d.__next||null;if(!E.finished){o.dataUrl=u(A,Math.min(B,z),N);R.sendRequest(o).then(v).catch(O)}E.rows=n(x);P(E)}o={serviceUrl:q(D.serviceUrl),dataUrl:u(0,B),method:D.useBatch?"BATCH":"GET",headers:D.headers};R.sendRequest(o).then(v).catch(O);return{cancel:function(){C=true}}}m.exports={requestData:k,getConverter:i};},{"./RequestHandler.js":4}],4:[function(a,m,b){var H="HTTP connection error";function s(r){if(typeof r!=="object"||r===null||typeof r.dataUrl!=="string"){throw new Error("Unable to send request - Mandatory parameters missing.")}return(r.method==="BATCH"&&r.serviceUrl?h:f)(r)}function f(r){return new Promise(function(R,c){var x=new XMLHttpRequest;x.onload=function(){if(this.status>=400){c(this.responseText);return}try{R(JSON.parse(this.responseText))}catch(e){c("Server response is not a valid JSON:\n"+this.responseText)}};x.onerror=function(){c(H)};x.onabort=function(){c(H)};x.open("GET",r.dataUrl,true);x.setRequestHeader("accept","application/json");x.send()})}function g(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c==="x"?r:r&3|8;return v.toString(16)})}function h(r){return new Promise(function(R,c){var x=new XMLHttpRequest;var i="batch_"+g();var j=r.dataUrl.split(r.serviceUrl)[1];var k=[];x.onload=function(){var n=this.responseText;var L=this.responseText.split("\r\n");var S=0,o=L.length,E=o-1;while(S<o&&L[S].slice(0,1)!=="{"){S++}while(E>0&&L[E].slice(-1)!=="}"){E--}L=L.slice(S,E+1);n=L.join("\r\n");try{var p=JSON.parse(n);R(p)}catch(e){c("Server response is not a valid JSON")}};x.onerror=function(){c(H)};x.onabort=function(){c(H)};x.open("POST",r.serviceUrl+"$batch",true);x.setRequestHeader("Accept","multipart/mixed");x.setRequestHeader("Content-Type","multipart/mixed;boundary="+i);for(var l in r.headers){if(l.toLowerCase()!="accept"){x.setRequestHeader(l,r.headers[l])}}k.push("--"+i);k.push("Content-Type: application/http");k.push("Content-Transfer-Encoding: binary");k.push("");k.push("GET "+j+" HTTP/1.1");for(var l in r.headers){k.push(l+":"+r.headers[l])}k.push("");k.push("");k.push("--"+i+"--");k.push("");k=k.join("\r\n");x.send(k)})}m.exports={sendRequest:s};},{}]},{},[1])(1)});
